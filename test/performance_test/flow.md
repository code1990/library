##（一）问清性能需求
**通用的性能测试思路**

首先，要问本次性能测试的需求是什么，或者性能测试的目的是什么？ 性能测试分类：

1）新系统能力验证

刚好开发了一个新系统，你可以有更多的自由选择测试环境、压力点和测试工具

2）客户有明确要求

用户提要求了，这个比较容易，你可以对现系统做一次性能测试。

3）找出系统性能瓶颈

目的就是找出系统的性能瓶颈，进行调优或硬件扩容，重点在系统的架构分析和业务分析上面。

4）稳定性验证（强度测试）

稳定性是系统的一个重要指标，典型的就是内存溢出，要考虑性能测试的运行时长。

* 当拿到需求时一定要问测试的目的，会显得你很专业；

* 通过测试目的可以知道后续性能测试工作的重点在哪儿？
##（二）
![](https://i.imgur.com/9ngfuGR.jpg)

表示层：通过浏览器将系统功能和数据展示给用户，并与用户实现交互。

业务逻辑层：作为中间层实现核心业务逻辑服务。

数据层：运行在数据库主机上，负责整个系统中数据信息的存储。

一个大型的系统在设计中使用了哪些手段或技术来提高系统的性能呢
![](https://i.imgur.com/bsjRjQQ.png)

常用的系统架构:

* Linux + Apache + PHP + MySQL
* Linux + Nginx + Redis +  PHP + MySQL
* Linux + Apache + Tomcat + Java+ Oracle
* Windows Server 2003/2008 + IIS + C#/ASP.NET + 数据库
* Window Server 2003/2008 + tomcat + MySql/Oracle/ + Java
* Linux + Python + uwsgi + Nginx + MySQL
##（三）分析测试点
分析一下性能测试点。这关系到你测试工具的选型。

性能测试点的选取

* 发生频率非常高的（例如收发邮件等业务）
* 关键程度非常高的（如登录等）
* 资源占用非常严重的（导致磁盘I/O非常大的）

对性能需求点的描述 

    准确：响应时间内准确。

    一致：用户和性能测试工程师对有关术语的理解要一致

    特定：性能测试的需求一定是有条件的。

一般性能需求描述

* Web首页打开速度5s以下，Web登陆速度 15s以下。
* 邮件服务支持50万个在线用户
* 计费话单成功率达到99.999%以上。
* 在100个并发用户的高峰期，邮箱的基本功能，处理能力至少达到10QPS(TPS)
* 系统能在高于实际系统运行压力1倍的情况下，稳定的运行12小时。
* 这个系统能否支撑200万的VU（每天登录系统的虚拟用户） 

##（四）测试工具选型
测试工具的比较
![](https://i.imgur.com/rweEmBh.png)
需要考虑以下几个方面:

* 性能需求：首先要考虑的是否满足性能需求
* 购买成本：对于商业工具的购买成本也是我们需要考虑的问题
* 人员学习成本：最后要提到的就是人员对工具的学习成本


##（五）测试计划

一．简介

项目的背景，进行此次性能测试的原因，以及性能测试覆盖的范围等等  

二．性能测试需求

寻找的被测试对象和压力点是经过分析与系统数据收集得到。以下取几个典型的压力点。

登录，查询，交易，

    
三．测试环境

测试环境主要指的软件硬件环境和网络环境。

* 软件环境：指项目运行的环境
* 硬件环境：包括主机内部部件
* 网络环境：在一个局域网中进行，还应该保证这个网络的独立性
	
四．数据准备

系统所需数据的分析可以参考以下方式：

* 历史数据分析有助于数据量级的确定。从历史数据入手，找出高峰期数据量。
* 从其他相似或者相同系统入手，进行数据分析，找出高峰期数据量。
* 无历史或者相关系统可以参考的时候，就要对系统的性能数据进行估算


  
五．测试工具

引入什么样的工具适合性能需求。


六．测试策略

* 在一些特定的条件下，可能出现短时间内用户集中访问某个业务系统的情况。
* 另一方面，系统性能的验证必须做到“覆盖全面”。

七．人力与时间安排

  最后一条，就是要根据项目的进度要求以及规模，来进行人力与时间的安排。


##（六）测试环境搭建
性能测试环境与功能测试环境的区别

* 功能测试的测试环境，一台服务器可以运行多个系统
* 性能测试是要对整个系统运行的软件硬件环境进行测试的


保证测试环境与生产环境的一致性 

1、硬件环境，包括服务器环境、与网络环境

2、软件环境     版本一致性     配置一致性

3、使用场景的一致性     

* 基础数据的一致性包括预测的业务数据量，以及数据类型的分配。
* 使用模式的一致性尽量模拟真实场景下用户的使用情况


实施策略

我们一般通过两种策略来搭建性能测试环境（预估方式均有误差）

* 1、通过建模的方式实现低端硬件对高端硬件的模拟
* 2、通过集群的方式计算

##（七）测试执行


参考测试计划，大概执行过程如下：



参考测试计划，大概执行过程如下：

* 1、准备测试数据
* 2、使用测试工具模拟测试点，回放OK
* 3、根据测试策略，使用不同的虚拟用户和测试组合 运行测试。
* 4、监控系统CPU、内存、中间件，数据库的性能，收集数据。
* 5、重复3、4。



##（八）性能调优

系统一般会存在哪些瓶颈：

* 硬件上的性能瓶颈：一般指的是CPU、内存、磁盘I/O 。
* 应用软件上的性能瓶颈：一般指的是应用服务器、web 服务器等应用软件，还包括数据库系统。
* 应用程序上的性能瓶颈：一般指的是开发人员新开发出来的应用程序。
* 操作系统上的性能瓶颈：一般指的是windows、UNIX、Linux等操作系统。
* 网络设备上的性能瓶颈：一般指的是防火墙、动态负载均衡器、交换机等设备。

一般性能调优步骤                                                                                      

**步骤一：确定问题**

应用程序代码：很多程序的性能问题都是写出来的，应该首先检查一下代码。

数据库配置：经常引起整个系统运行缓慢。

操作系统配置：不合理就可能引起系统瓶颈。

硬件设置：硬盘速度、内存大小等都是容易引起瓶颈的原因，因此这些都是分析的重点。

网络：网络负载过重导致网络冲突和网络延迟。

**步骤二：分析问题**

当确定了问题之后，我们要明确这个问题影响的是响应时间吞吐量，还是其他问题？

**步骤三： 确定调整目标和解决方案**

得高系统吞吐量，缩短响应时间，更好地支持并发。

**步骤四：测试解决方案**

对通过解决方案调优后的系统进行基准测试。

**步骤五：分析调优结果**

系统调优是否达到或者超出了预定目标？